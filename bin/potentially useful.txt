

    def base_sample_dir = "/home/dlejeune/Documents/real_data/do_dump/pools"
    def cap_num = "CAP008"
    def file_selector =  "${base_sample_dir}/*/${cap_num}**-degapped.fasta"

    def input_files = files(file_selector)
    def basename_file_lookup = [:]
    
    for (filepath in input_files){
        def current_basename = filepath.baseName
        if (!basename_file_lookup.containsKey(current_basename)){
                        basename_file_lookup[current_basename] = []           
        }
        
         basename_file_lookup[current_basename].add(filepath)
    }
    
    def staging_dir = "/home/dlejeune/Documents/real_data/temp/"
    
    
    for (item in basename_file_lookup){
    
        def file_list = item.value
        
        if (file_list.size() > 1){
            def concat_file = new File(staging_dir + item.key + ".concat.fasta")
            concat_file.write("")
            for (filepath in file_list){
                def current_file = new File(filepath.toString())
                concat_file << current_file.text
            }

        }   else{
            def old_file = new File(file_list[0].toString())
            def new_file = new File(staging_dir + item.key + ".fasta")
            
            new_file.write(old_file.text)
        }
        
    }
    